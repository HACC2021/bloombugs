!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SVGInjector={})}(this,(function(e){"use strict";function t(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var r=new Map,n=function(e){return e.cloneNode(!0)},i=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,o=/\\([\u000b\u0020-\u00ff])/g,a=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,l=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;"function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]);if("string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var r=t.indexOf(";"),n=-1!==r?t.substr(0,r).trim():t.trim();if(!a.test(n))throw new TypeError("invalid media type");var l=new s(n.toLowerCase());if(-1!==r){var u,c,f;for(i.lastIndex=r;c=i.exec(t);){if(c.index!==r)throw new TypeError("invalid parameter format");r+=c[0].length,u=c[1].toLowerCase(),'"'===(f=c[2])[0]&&(f=f.substr(1,f.length-2).replace(o,"$1")),l.parameters[u]=f}if(r!==t.length)throw new TypeError("invalid parameter format")}return l};function s(e){this.parameters=Object.create(null),this.type=e}var u=function(){return"file:"===window.location.protocol},c=function(e,t,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){try{if(!/\.svg/i.test(e)&&2===n.readyState){var t=n.getResponseHeader("Content-Type");if(!t)throw new Error("Content type not found");var i=l(t).type;if("image/svg+xml"!==i&&"text/plain"!==i)throw new Error("Invalid content type: "+i)}if(4===n.readyState){if(404===n.status||null===n.responseXML)throw new Error(u()?"Note: SVG injection ajax calls do not work locally without adjusting security settings in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+e);if(!(200===n.status||u()&&0===n.status))throw new Error("There was a problem injecting the SVG: "+n.status+" "+n.statusText);r(null,n)}}catch(e){if(n.abort(),!(e instanceof Error))throw e;r(e,n)}},n.open("GET",e),n.withCredentials=t,n.overrideMimeType&&n.overrideMimeType("text/xml"),n.send()},f={},d=function(e,t){f[e]=f[e]||[],f[e].push(t)},p=function(e,t,i){if(r.has(e)){var o=r.get(e);if(void 0===o)return void d(e,i);if(o instanceof SVGSVGElement)return void i(null,n(o))}r.set(e,void 0),d(e,i),c(e,t,(function(t,i){t?r.set(e,t):i.responseXML instanceof Document&&i.responseXML.documentElement&&i.responseXML.documentElement instanceof SVGSVGElement&&r.set(e,i.responseXML.documentElement),function(e){for(var t=function(t,i){setTimeout((function(){if(Array.isArray(f[e])){var i=r.get(e),o=f[e][t];i instanceof SVGSVGElement&&o(null,n(i)),i instanceof Error&&o(i),t===f[e].length-1&&delete f[e]}}),0)},i=0,o=f[e].length;i<o;i++)t(i)}(e)}))},h=function(e,t,r){c(e,t,(function(e,t){e?r(e):t.responseXML instanceof Document&&t.responseXML.documentElement&&t.responseXML.documentElement instanceof SVGSVGElement&&r(null,t.responseXML.documentElement)}))},v=0,g=[],m={},y="http://www.w3.org/1999/xlink",w=function(e,r,n,i,o,a,l){var s=e.getAttribute("data-src")||e.getAttribute("src");if(s){if(-1!==g.indexOf(e))return g.splice(g.indexOf(e),1),void(e=null);g.push(e),e.setAttribute("src",""),(i?p:h)(s,o,(function(i,o){if(!o)return g.splice(g.indexOf(e),1),e=null,void l(i);var u=e.getAttribute("id");u&&o.setAttribute("id",u);var c=e.getAttribute("title");c&&o.setAttribute("title",c);var f=e.getAttribute("width");f&&o.setAttribute("width",f);var d=e.getAttribute("height");d&&o.setAttribute("height",d);var p=Array.from(new Set(t(t(t([],(o.getAttribute("class")||"").split(" "),!0),["injected-svg"],!1),(e.getAttribute("class")||"").split(" "),!0))).join(" ").trim();o.setAttribute("class",p);var h=e.getAttribute("style");h&&o.setAttribute("style",h),o.setAttribute("data-src",s);var w=[].filter.call(e.attributes,(function(e){return/^data-\w[\w-]*$/.test(e.name)}));if(Array.prototype.forEach.call(w,(function(e){e.name&&e.value&&o.setAttribute(e.name,e.value)})),n){var b,A,E,x,S={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(S).forEach((function(e){A=S[e];for(var t=function(e,t){var r;x=(E=b[e].id)+"-"+ ++v,Array.prototype.forEach.call(A,(function(e){for(var t=0,n=(r=o.querySelectorAll("["+e+'*="'+E+'"]')).length;t<n;t++){var i=r[t].getAttribute(e);i&&!i.match(new RegExp('url\\("?#'+E+'"?\\)'))||r[t].setAttribute(e,"url(#"+x+")")}}));for(var n=o.querySelectorAll("[*|href]"),i=[],a=0,l=n.length;a<l;a++){var s=n[a].getAttributeNS(y,"href");s&&s.toString()==="#"+b[e].id&&i.push(n[a])}for(var u=0,c=i.length;u<c;u++)i[u].setAttributeNS(y,"href","#"+x);b[e].id=x},r=0,n=(b=o.querySelectorAll(e+"[id]")).length;r<n;r++)t(r)}))}o.removeAttribute("xmlns:a");for(var j,G,T=o.querySelectorAll("script"),k=[],M=0,V=T.length;M<V;M++)(G=T[M].getAttribute("type"))&&"application/ecmascript"!==G&&"application/javascript"!==G&&"text/javascript"!==G||((j=T[M].innerText||T[M].textContent)&&k.push(j),o.removeChild(T[M]));if(k.length>0&&("always"===r||"once"===r&&!m[s])){for(var L=0,q=k.length;L<q;L++)new Function(k[L])(window);m[s]=!0}var C=o.querySelectorAll("style");if(Array.prototype.forEach.call(C,(function(e){e.textContent+=""})),o.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.setAttribute("xmlns:xlink",y),a(o),!e.parentNode)return g.splice(g.indexOf(e),1),e=null,void l(new Error("Parent node is null"));e.parentNode.replaceChild(o,e),g.splice(g.indexOf(e),1),e=null,l(null,o)}))}else l(new Error("Invalid data-src or src attribute"))};e.SVGInjector=function(e,t){var r=void 0===t?{}:t,n=r.afterAll,i=void 0===n?function(){}:n,o=r.afterEach,a=void 0===o?function(){}:o,l=r.beforeEach,s=void 0===l?function(){}:l,u=r.cacheRequests,c=void 0===u||u,f=r.evalScripts,d=void 0===f?"never":f,p=r.httpRequestWithCredentials,h=void 0!==p&&p,v=r.renumerateIRIElements,g=void 0===v||v;if(e&&"length"in e)for(var m=0,y=0,b=e.length;y<b;y++)w(e[y],d,g,c,h,s,(function(t,r){a(t,r),e&&"length"in e&&e.length===++m&&i(m)}));else e?w(e,d,g,c,h,s,(function(t,r){a(t,r),i(1),e=null})):i(0)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=svg-injector.umd.production.js.map
