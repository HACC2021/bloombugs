"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createAutoField = void 0;
var tslib_1 = require("tslib");
var invariant_1 = tslib_1.__importDefault(require("invariant"));
var react_1 = require("react");
var useField_1 = require("./useField");
function createAutoField(defaultComponentDetector) {
    var context = react_1.createContext(defaultComponentDetector);
    function AutoField(rawProps) {
        var _a, _b;
        var _c = useField_1.useField(rawProps.name, rawProps), props = _c[0], uniforms = _c[1];
        var componentDetector = react_1.useContext(context);
        var component = (_a = props.component) !== null && _a !== void 0 ? _a : componentDetector(props, uniforms);
        invariant_1.default(component, 'AutoField received no component for: %s', props.name);
        return 'options' in component && ((_b = component.options) === null || _b === void 0 ? void 0 : _b.kind) === 'leaf'
            ? react_1.createElement(component.Component, props)
            : react_1.createElement(component, rawProps);
    }
    return Object.assign(AutoField, {
        componentDetectorContext: context,
        defaultComponentDetector: defaultComponentDetector,
    });
}
exports.createAutoField = createAutoField;
